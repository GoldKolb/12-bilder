<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>360Â° Schmuck</title>
  <style>
    body {
      margin: 0;
      background-color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    canvas {
      cursor: default;
    }
  </style>
</head>
<body>
  <canvas id="viewer" width="800" height="800"></canvas>

  <script>
    const canvas = document.getElementById('viewer');
    const ctx = canvas.getContext('2d');

    const frameCount = 12;
    const images = [];
    let currentFrame = 0;
    let isDragging = false;
    let startX = 0;
    let autoRotate = true;
    let rotateInterval;
    let inactivityTimer;

    function preloadImages() {
      for (let i = 1; i <= frameCount; i++) {
        const img = new Image();
        const number = i.toString().padStart(2, '0'); // 01, 02, ...
        img.src = `EinzelA${number}.jpg`;
        images.push(img);
      }
    }

    function drawFrame(index) {
      const img = images[index];
      if (img && img.complete) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      }
    }

    function startAutoRotate() {
      stopAutoRotate();
      rotateInterval = setInterval(() => {
        currentFrame = (currentFrame + 1) % frameCount;
        drawFrame(currentFrame);
      }, 100); // Geschwindigkeit: 100ms pro Bild
      autoRotate = true;
    }

    function stopAutoRotate() {
      clearInterval(rotateInterval);
      autoRotate = false;
    }

    function resetInactivityTimer() {
      clearTimeout(inactivityTimer);
      inactivityTimer = setTimeout(() => {
        if (!autoRotate) {
          startAutoRotate();
        }
      }, 5000); // 5 Sekunden bis Neustart
    }

    canvas.addEventListener('mousedown', (e) => {
      isDragging = true;
      startX = e.clientX;
      stopAutoRotate();
    });

    canvas.addEventListener('mousemove', (e) => {
      if (isDragging) {
        const delta = e.clientX - startX;
        if (Math.abs(delta) > 5) {
          const direction = delta > 0 ? -1 : 1;
          currentFrame = (currentFrame + direction + frameCount) % frameCount;
          drawFrame(currentFrame);
          startX = e.clientX;
        }
        resetInactivityTimer();
      }
    });

    canvas.addEventListener('mouseup', () => {
      isDragging = false;
    });

    canvas.addEventListener('mouseleave', () => {
      isDragging = false;
    });

    canvas.addEventListener('touchstart', (e) => {
      isDragging = true;
      startX = e.touches[0].clientX;
      stopAutoRotate();
    });

    canvas.addEventListener('touchmove', (e) => {
      if (isDragging) {
        const delta = e.touches[0].clientX - startX;
        if (Math.abs(delta) > 5) {
          const direction = delta > 0 ? -1 : 1;
          currentFrame = (currentFrame + direction + frameCount) % frameCount;
          drawFrame(currentFrame);
          startX = e.touches[0].clientX;
        }
        resetInactivityTimer();
      }
    });

    canvas.addEventListener('touchend', () => {
      isDragging = false;
    });

    window.onload = () => {
      preloadImages();
      const checkLoaded = setInterval(() => {
        if (images.every(img => img.complete)) {
          clearInterval(checkLoaded);
          drawFrame(currentFrame);
          startAutoRotate();
        }
      }, 100);
    };
  </script>
</body>
</html>
