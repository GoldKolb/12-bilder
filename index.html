<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>360째 Schmuck</title>
  <style>
    body {
      background: black;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    canvas {
      width: 1000px;
      height: 1000px;
      user-select: none;
    }
  </style>
</head>
<body>
  <canvas id="viewer" width="1000" height="1000"></canvas>

  <script>
    const canvas = document.getElementById('viewer');
    const ctx = canvas.getContext('2d');

    const frameCount = 12;
    const images = [];
    let currentFrame = 0;
    let isDragging = false;
    let startX = 0;
    let autoRotate = true;
    let inactivityTimeout;

    // Lade alle Bilder
    for (let i = 1; i <= frameCount; i++) {
      const number = i.toString().padStart(2, '0'); // 01, 02, ...
      const img = new Image();
      img.src = `EinzelA${number}.JPG`;
      images.push(img);
    }

    // Zeige Bild
    function drawFrame(index) {
      const img = images[index];
      if (img.complete) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      } else {
        img.onload = () => drawFrame(index);
      }
    }

    // Automatische Rotation
    function autoRotateLoop() {
      if (autoRotate) {
        currentFrame = (currentFrame + 1) % frameCount;
        drawFrame(currentFrame);
      }
      requestAnimationFrame(autoRotateLoop);
    }

    // Inaktivit채t resetten
    function resetInactivityTimer() {
      clearTimeout(inactivityTimeout);
      inactivityTimeout = setTimeout(() => {
        autoRotate = true;
      }, 5000); // 5 Sekunden
    }

    // Maus-Events
    canvas.addEventListener('mousedown', (e) => {
      isDragging = true;
      autoRotate = false;
      startX = e.clientX;
      resetInactivityTimer();
    });

    canvas.addEventListener('mouseup', () => {
      isDragging = false;
      resetInactivityTimer();
    });

    canvas.addEventListener('mouseleave', () => {
      isDragging = false;
    });

    canvas.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      const deltaX = e.clientX - startX;
      if (Math.abs(deltaX) > 5) {
        if (deltaX > 0) {
          currentFrame = (currentFrame - 1 + frameCount) % frameCount;
        } else {
          currentFrame = (currentFrame + 1) % frameCount;
        }
        drawFrame(currentFrame);
        startX = e.clientX;
        resetInactivityTimer();
      }
    });

    // Touch-Events (f체r Mobilger채te)
    canvas.addEventListener('touchstart', (e) => {
      if (e.touches.length === 1) {
        isDragging = true;
        autoRotate = false;
        startX = e.touches[0].clientX;
        resetInactivityTimer();
      }
    });

    canvas.addEventListener('touchend', () => {
      isDragging = false;
      resetInactivityTimer();
    });

    canvas.addEventListener('touchmove', (e) => {
      if (!isDragging || e.touches.length !== 1) return;
      const deltaX = e.touches[0].clientX - startX;
      if (Math.abs(deltaX) > 5) {
        if (deltaX > 0) {
          currentFrame = (currentFrame - 1 + frameCount) % frameCount;
        } else {
          currentFrame = (currentFrame + 1) % frameCount;
        }
        drawFrame(currentFrame);
        startX = e.touches[0].clientX;
        resetInactivityTimer();
      }
    });

    // Start
    drawFrame(currentFrame);
    autoRotateLoop();
  </script>
</body>
</html>
